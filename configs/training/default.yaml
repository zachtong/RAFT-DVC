# RAFT-DVC Training Configuration

# Data configuration
data:
  train_dataset: "data/train"
  val_dataset: "data/val"
  batch_size: 2
  num_workers: 4
  volume_size: [64, 64, 64]  # [D, H, W]

# Model configuration
model:
  input_channels: 1
  feature_dim: 128
  hidden_dim: 96
  context_dim: 64
  corr_levels: 4
  corr_radius: 4
  iters: 12

# Training configuration
training:
  epochs: 100
  learning_rate: 0.0001
  weight_decay: 0.0001
  grad_clip: 1.0
  mixed_precision: true

# Optimizer
optimizer:
  type: "AdamW"
  betas: [0.9, 0.999]
  eps: 1.0e-8

# Learning rate scheduler
scheduler:
  type: "OneCycleLR"
  max_lr: 0.0004
  pct_start: 0.05
  anneal_strategy: "cos"

# Loss weights
loss:
  gamma: 0.8  # Exponential weight decay for multi-scale loss

# Checkpoint
checkpoint:
  save_dir: "checkpoints"
  save_freq: 5  # Save every N epochs
  keep_last_n: 3  # Keep only last N checkpoints

# Logging
logging:
  log_dir: "logs"
  tensorboard: true
  log_freq: 10  # Log every N iterations

# Device
device:
  cuda: true
  gpu_id: 0
  deterministic: false
  seed: 1234
